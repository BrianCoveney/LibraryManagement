<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en" th:replace="fragments/head :: head"></head>
<body>
<header th:replace="fragments/header :: header"></header>
<main>
    <form id="form1" action="#" th:action="@{/search}" th:object="${searchForm}", method="post">

      <label class="search-label">Find book(s) by author:</label>
        <input name="author" id="search0" type="text" placeholder="e.g, Robert Martin">
        <span class="form-error"
            th:if="${#fields.hasErrors('author')}"
            th:errors="*{author}">Invalid title</span>

      <label class="search-label">Find book by title:</label>
      <input name="title" id="search1" type="text" placeholder="e.g, Spring in action">
      <span class="form-error"
            th:if="${#fields.hasErrors('title')}"
            th:errors="*{title}">Invalid title</span>

        <input id="submit" class="button" type="submit" value="Search" />
      <div th:if="${not #lists.isEmpty(searchForm)}">
          <h3>Search results:</h3>
          <table class="members-table">
            <tr>
              <th>Book Title</th>
              <th>Book Author</th>
              <th>On Loan to Member ID</th>
              <th>On Loan to Member Name</th>
            </tr>

            <!--We get the books from the form-->
            <tr th:each="book: ${searchForm.books}">
              <td th:if="${book.title != null}" th:text="${book.title}"></td>
              <td th:if="${book.author != null}" th:text="${book.author}"></td>
              <td>
                <div th:each="element: ${bookmembermap}">
                  <span id="search-span" class="title3" th:text="${element.value.memberID}">No Id!</span>
                </div>
              </td>
              <td>
                <div th:each="element: ${bookmembermap}">
                  <span id="search-span" class="title3" th:text="${element.value.name}">No Id!</span>
                </div>
              </td>

            </tr>

          </table>
        </div>
    </form>
    <form id="form2" action="#" th:action="@{/search}" th:object="${booksAll}">
        <input type="button" class="button" id="find-all-button" value="Show All Books" onclick="findAllButtonClick()" />
        <div id="all-books-cont" style="display: none">
        <h3 id="all-books">All books:</h3>
        <table class="members-table">
          <tr>
            <th>Title</th>
            <th>Author</th>
          </tr>
          <tr th:each="b: ${booksAll}">
            <td th:text="${b.title}">No Title!</td>
            <td th:text="${b.author}">No Author!</td>
          </tr>
        </table>
        </div>
    </form>
</main>
<footer th:replace="fragments/footer :: footer"></footer>

<script>
    function findAllButtonClick() {
        var booksDivContainer = document.getElementById("all-books-cont");
        var toggleButton = document.getElementById("find-all-button");

        if(booksDivContainer.style.display === "none") {
            booksDivContainer.style.display = "block";
        } else {
            booksDivContainer.style.display = "none";
        }

        if (toggleButton.value === "Show All Books") {
            toggleButton.value = "Hide All Books"
        } else {
            toggleButton.value = "Show All Books"
        }
    }
</script>

</body>
</html>
